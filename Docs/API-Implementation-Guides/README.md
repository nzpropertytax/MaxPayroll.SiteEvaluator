# API Implementation Guides ??

<div align="center">

```
????????????????????????????????????????????????????????????????????
?                                                                  ?
?   ?? API IMPLEMENTATION GUIDES                                   ?
?                                                                  ?
?   Technical documentation for NZ property data APIs              ?
?                                                                  ?
????????????????????????????????????????????????????????????????????
```

</div>

---

## ?? API Documentation

| Document | Status | Description |
|----------|--------|-------------|
| [LINZ Address API](LINZ-Address-API.md) | ? Implemented | Free address geocoding |
| [LINZ Landonline API](LINZ-Landonline-API.md) | ?? Partial | Paid title and ownership data |
| [Council GIS APIs](Council-GIS-APIs.md) | ? Implemented | Zoning and hazard data |
| [GNS Science API](GNS-Science-API.md) | ? Implemented | Seismic and fault data |
| [NZGD API](NZGD-API.md) | ? Implemented | Geotechnical database |
| [NIWA API](NIWA-API.md) | ? Implemented | Climate and rainfall data |

---

## ??? Data Flow Overview

```
???????????????????????????????????????????????????????????????????
?                     SITE EVALUATOR                               ?
?                                                                  ?
?  User Input     ????????????????                                ?
?  (Address)  ??? ? LINZ Address ? ??? Coordinates                ?
?                 ????????????????                                ?
?                        ?                                         ?
?         ???????????????????????????????                         ?
?         ?              ?              ?                         ?
?  ????????????   ????????????   ????????????                    ?
?  ? Council  ?   ? GNS/NZGD ?   ?  NIWA    ?                    ?
?  ?   GIS    ?   ?  Science ?   ? Climate  ?                    ?
?  ????????????   ????????????   ????????????                    ?
?         ?              ?              ?                         ?
?         ?              ?              ?                         ?
?  ????????????????????????????????????????????                  ?
?  ?         Site Evaluation Report            ?                  ?
?  ????????????????????????????????????????????                  ?
???????????????????????????????????????????????????????????????????
```

---

## ?? API Authentication

| API | Auth Type | Free Tier | Cost |
|-----|-----------|-----------|------|
| **LINZ Data Service** | API Key | ? Yes | Free |
| **LINZ Landonline** | OAuth2 | ? No | Per query |
| **Council GIS** | None | ? Yes | Free |
| **GeoNet (GNS)** | None | ? Yes | Free |
| **NZGD** | None | ? Yes | Free |
| **NIWA** | API Key | ?? Limited | Per request |

---

## ?? Implementation Status

### Fully Implemented ?

| Service | Features |
|---------|----------|
| **LINZ Address** | Address autocomplete, geocoding |
| **Council GIS** | Christchurch, Auckland, Wellington |
| **GNS Science** | Seismic zones, fault proximity |
| **NZGD** | Borehole/CPT proximity search |
| **NIWA** | Wind zones, rainfall estimates |

### Partially Implemented ??

| Service | Status | Missing |
|---------|--------|---------|
| **LINZ Landonline** | Stub | Paid subscription required |
| **NIWA HIRDS** | Estimated | Direct API access unavailable |

### Planned ??

| Service | Target | Notes |
|---------|--------|-------|
| Regional councils | Q1 2025 | Hamilton, Tauranga, Dunedin |
| Statistics NZ | Q2 2025 | Census/demographic data |
| Heritage NZ | Q2 2025 | Historic places |

---

## ??? Service Implementation Pattern

All API services follow a consistent pattern:

```csharp
public interface IYourApiService
{
    Task<YourData?> GetDataAsync(
        double lat, double lon, 
        CancellationToken ct = default);
}

public class YourApiService : IYourApiService
{
    private readonly HttpClient _httpClient;
    private readonly ILogger<YourApiService> _logger;

    public async Task<YourData?> GetDataAsync(...)
    {
        try
        {
            // Try real API
            var result = await TryApiAsync(...);
            if (result != null) return result;
        }
        catch (Exception ex)
        {
            _logger.LogWarning(ex, "API failed");
        }
        
        // Fall back to static/estimated data
        return GetStaticData(...);
    }
}
```

---

## ?? File Structure

```
Services/Integration/
??? IntegrationInterfaces.cs    # All interfaces
??? LinzDataService.cs          # LINZ APIs
??? CouncilServices.cs          # Council GIS (multiple)
??? GnsNiwaServices.cs          # GNS + NIWA
??? NzgdDataService.cs          # Geotechnical database
```

---

## ?? Related Documentation

- [Service Implementation Guide](../development/Service-Implementation-Guide.md)
- [User Guides](../user-guides/README.md)
- [Main Documentation](../README.md)

---

## ?? API Support Contacts

| API | Contact |
|-----|---------|
| LINZ | data.linz.govt.nz |
| GeoNet | geonet.org.nz |
| NZGD | nzgd.org.nz |
| NIWA | niwa.co.nz |
